---
title: "Data Visualization HW 3"
author: "George Nakhleh"
date: "February 23, 2016"
output: pdf_document
---

# CSC 465 HW 2
### George Nakhleh

##Question 2  


####Choose two techniques that we covered in class and for each, create a graph of some aspect of your data using the technique. One of these should be from lecture 5-7. The purpose of this is to get your group trying  
  
*a) Analyzing correlation beteen different community indicators and some 311 request types*  
This is at the community area level

```{r eval=FALSE}
corrplot(cor_table, method="ellipse")
corrplot(cor_table)
```
* `pop` = population
* `latinoper` = percent latino
* `blackper` = percent black
* `whiteper` = percent white
* `asianper` = percent asian
* `percent_other` = percent other ethnicity
* `ownerocc` = percent of residences owner-occupied
* `povertyper` = percent of residents below poverty line
* `income` = median income
* `edu` = percent with bachelor's degree or higher
* `garbage_311` = garbage cart violations (normalized for population)
* `rats_311` = rodent baiting requests (normalized for population)
* `aban_cars_311` = abandoned vehicle complaints (normalized for population)

![](C:\Users\George\Documents\Data_Visualization\HW3\HW3_q2a.png)



\pagebreak

*b) Looking for outlier communities in the data*  

![](C:\Users\George\Documents\Data_Visualization\Final Project\Copy of alleylight_reqs_per1k.v2.png)


\pagebreak

##Question 3  

####Prepare a first in-depth visualization of your data for the final project.  

*Created a regression model to predict abandoned car reports per community area. Selected variables with a step-wise regression, and then plotted the residuals.*  

I chose this for a few reasons:

* I want to practice practical workflows from statistical analysis to visualization
* I'm interested in algorithm auditing and data ethics: In using stepwise, I am letting the computer suggest to me the best model, and with this dataset it's likely that it would choose ethnicity variables. Is that ethical, even if it's optimal? Also, once the decision has been made, it's possible to have a workflow that obscures the choices made as it goes on. 
* Opportunity to think about color choices

```{r eval=FALSE}
ggplot(data=community_311_corsubset, aes(x=aban_cars_311, y=resids)) + 
  geom_point(size=4, color="grey60") + geom_point(size = 3, alpha=0.5, aes(color=-abs(resids))) + 
  geom_hline(yintercept = 0) + 
  scale_colour_gradientn(colours = heat.colors(N), name="Prediction Accuracy", breaks = c(-5,-10), labels = c("Close", "Far off")) +
  labs(title = "Accuracy Testing A Predictive Model \n Abandoned Vehicles", x="Abandoned Car Reports per 1k residents (Chicago 311, 2014-2016)", y="Residuals") +
  theme(plot.title = element_text(size=18, face="bold"), 
        axis.title = element_text(size = 18, face="bold"), axis.title.y = element_text(angle=0),
        axis.text = element_text(size=14)) +
  annotate(geom="text", x=20, y=11, label = "Each point = community area", color = 'seagreen3', size = 4.25)
```
![](C:\Users\George\Documents\Data_Visualization\HW3\hw3_q3_final2.png)

At first, I just wanted to see the results of the residual analysis, and all I knew how to do was the plot function for this.  

Then, I figured out that I could just put the residuals into a dataset w/ the actual values and graph that in ggplot. From there, I had to consider what it was I wanted to be showing. I wanted to see where the model was failing, so I changed the color scheme to highlight that. I made some tweaks to get the dots how I wanted them, and now I'm set.   

\pagebreak

You can see some of the iterations I went through here:  

![](C:\Users\George\Documents\Data_Visualization\Final Project\abandoned_vehicles.owners.png)

![](C:\Users\George\Documents\Data_Visualization\HW3\hw3_q3_old3.png)

![](C:\Users\George\Documents\Data_Visualization\HW3\hw3_q3_old2.png)

![](C:\Users\George\Documents\Data_Visualization\HW3\hw3_q3_old1.png)

![](C:\Users\George\Documents\Data_Visualization\HW3\hw3_q3_final.png)

\pagebreak

##Question 4  

*The data is for the availability of food services by state and county in the U.S.*  

####a. Graph food services by state as a choropleth. Note any patterns that arise. Your visualization should clearly display states that have high levels or low levels of food service availability, so think carefully about the color scheme.  

Made using the choroplethr package in R, which allows for faster generation of choropleth maps.
```{r eval=FALSE}
library(maps)
library(mapdata)
library(mapproj)
#helpful one I found online
library(choroplethr)
library(choroplethrMaps)
library(dplyr)

#a
#Graph food svc's by state as a chloropleth.
#The graph should clearly display states w/ high or low levels

#for choroplethr to work, we need to get data in the format it likes
#for states, need state names in lower case and in a column titled "region"

#REFACTOR THIS LATER as a function
food_svc_statelevel<-dplyr::filter(foodservices,!is.na(State))
food_svc_statelevel <- slice(food_svc_statelevel, 2:dim(food_svc_statelevel)[1])
#remove Washington DC
food_svc_statelevel <- dplyr::filter(food_svc_statelevel,tolower(food_svc_statelevel$County) != "district of columbia")

food_svc_statelevel <- dplyr::select(food_svc_statelevel, County, FoodServices.97, FoodServices.2002, FoodServices.2007)

food_svc_statelevel <- rename(food_svc_statelevel, region = County)
food_svc_statelevel$region <- tolower(food_svc_statelevel$region)

food_svc_statelevel <- dplyr::select(food_svc_statelevel, region, FoodServices.2007)
food_svc_statelevel <- rename(food_svc_statelevel, value = FoodServices.2007)
food_svc_statelevel #should be a dataset with just 50 states ('region'), and the level of services 2007 ('value')

#TWO MAPS: 
#1 that highlights how far ahead California is
state_choropleth(food_svc_statelevel ,
                 title = "Food Services (2007)",
                 legend = "Food svc. availability",
                 num_colors = 1
                 )
```
![](C:\Users\George\Documents\Data_Visualization\HW3\HW3_q4a_v1.png)

```{r eval=FALSE}
#1 that tries to normalize
#state_choropleth by default chooses good practices from colorbrewer
state_choropleth(food_svc_statelevel ,
                 title = "Food Services (2007)",
                 legend = "Food svc. availability"
                 )

```
![](C:\Users\George\Documents\Data_Visualization\HW3\HW3_q4a_v2.png)

####b. Graph food services by county as a choropleth. Again, think carefully about the color scheme.  

Made in Tableau, edited w/ Google Drawings to get around constraints I was having in Tableau (zoom out to get Hawaii and Alaska obscuring the county-level data).
Uses a natural log scale to deal with outliers.
A bit rushed, as I spent a while trying to do this using the choroplethr package in R.   
![](C:\Users\George\Documents\Data_Visualization\HW3\CSC465_HW3_Q4b.jpg)

